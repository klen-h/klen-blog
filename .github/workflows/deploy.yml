# name: Deploy to GitHub Pages

# on:
#   push:
#     branches: [ master ]
#   workflow_dispatch:

# permissions:
#   contents: read
#   pages: write
#   id-token: write

# concurrency:
#   group: "pages"
#   cancel-in-progress: false

# jobs:
#   build:
#     runs-on: ubuntu-latest
    
#     steps:
#     - name: Checkout
#       uses: actions/checkout@v4
      
#     - name: Setup Node.js
#       uses: actions/setup-node@v4
#       with:
#         node-version: '18'
        
#     - name: Setup pnpm
#       uses: pnpm/action-setup@v2
#       with:
#         version: 8
        
#     - name: Get pnpm store directory
#       shell: bash
#       run: |
#         echo "STORE_PATH=$(pnpm store path --silent)" >> $GITHUB_ENV
        
#     - name: Setup pnpm cache
#       uses: actions/cache@v3
#       with:
#         path: ${{ env.STORE_PATH }}
#         key: ${{ runner.os }}-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}
#         restore-keys: |
#           ${{ runner.os }}-pnpm-store-
        
#     - name: Install dependencies
#       run: pnpm install
        
#     - name: Verify data file
#       run: |
#         echo "ğŸ“ æ£€æŸ¥æ•°æ®æ–‡ä»¶..."
#         if [ -f "data/posts.json" ]; then
#           echo "âœ… posts.json æ–‡ä»¶å­˜åœ¨"
#           echo "ğŸ“Š æ–‡ç« æ•°é‡: $(jq length data/posts.json)"
#         else
#           echo "âŒ posts.json æ–‡ä»¶ä¸å­˜åœ¨"
#           exit 1
#         fi
        
#     - name: Build static site
#       run: pnpm run generate
        
#     - name: Verify build output
#       run: |
#         echo "ğŸ“ æ£€æŸ¥æ„å»ºè¾“å‡º..."
#         if [ -d ".output/public" ]; then
#           echo "âœ… æ„å»ºè¾“å‡ºç›®å½•å­˜åœ¨"
#           echo "ğŸ“Š æ–‡ä»¶æ•°é‡: $(find .output/public -type f | wc -l)"
#           echo "ğŸ“ API æ–‡ä»¶: $(ls -la .output/public/api/ || echo 'APIç›®å½•ä¸å­˜åœ¨')"
#         else
#           echo "âŒ æ„å»ºè¾“å‡ºç›®å½•ä¸å­˜åœ¨"
#           exit 1
#         fi
        
#     - name: Upload artifact
#       uses: actions/upload-pages-artifact@v3
#       with:
#         path: .output/public

#   deploy:
#     environment:
#       name: github-pages
#       url: ${{ steps.deployment.outputs.page_url }}
#     runs-on: ubuntu-latest
#     needs: build
    
#     steps:
#     - name: Deploy to GitHub Pages
#       id: deployment
#       uses: actions/deploy-pages@v4
      
#     - name: Verify deployment
#       run: |
#         echo "ğŸš€ éƒ¨ç½²å®Œæˆï¼"
#         echo "ğŸŒ ç½‘ç«™åœ°å€: ${{ steps.deployment.outputs.page_url }}"
#         echo "ğŸ“Š æ„å»ºçŠ¶æ€: ${{ job.status }}"
